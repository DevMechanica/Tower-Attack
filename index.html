<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tower Attack</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="game-container">
        <canvas id="game-canvas"></canvas>
        <div id="ui-layer">

            <!-- New HUD / -->
            <div id="matchmaking-status" class="glass-panel hidden"
                style="position: absolute; top: 20px; right: 20px; padding: 10px 20px; z-index: 500; display: flex; align-items: center; gap: 15px; pointer-events: auto;">
                <div class="loader"></div>
                <span id="match-status-text">Searching for opponent...</span>
                <button id="cancel-match-btn" class="icon-btn"
                    style="background:none; border:none; color:white; font-size:1.2rem; cursor:pointer;">‚ùå</button>
            </div>

            <div id="hud-top" class="hidden">
                <div class="player-panel attacker">
                    <div class="panel-icon">üíé</div>
                    <div class="bar-container">
                        <div class="bar-label">P2 ATTACKER (BLUE)</div>
                        <div class="resource-bar">
                            <div class="fill" style="width: 50%;"></div>
                            <span class="value" id="attacker-gold">100</span>
                        </div>
                    </div>
                </div>

                <div class="vs-badge">VS</div>

                <div class="player-panel defender">
                    <div class="bar-container">
                        <div class="bar-label">P1 DEFENDER (RED) - GOLD</div>
                        <div class="health-bar">
                            <div class="fill" style="width: 100%;"></div>
                            <span class="value" id="defender-gold">5000</span>
                        </div>
                    </div>
                    <div class="panel-icon">üõ°Ô∏è</div>
                </div>
            </div>

            <button id="role-switch-btn" class="debug-btn hidden">SWITCH ROLE</button>

            <!-- Card Dock -->
            <div id="card-dock" class="hidden">
                <!-- Cards injected by JS -->
            </div>

            <!-- Contextual Sell Button -->
            <div id="sell-btn" class="context-btn" style="display: none;">
                <img src="assets/Icons/SellTowerIcon.png" alt="Sell">
            </div>

            <!-- Menu Button -->
            <button id="menu-btn" class="icon-btn hidden">‚ò∞</button>

            <!-- Main Menu Overlay -->
            <div id="main-menu" class="hidden">
                <div class="menu-content glass-panel">
                    <h2>PAUSED</h2>
                    <div class="menu-buttons">
                        <button id="resume-btn" class="primary-btn big-play-btn">RESUME</button>
                        <button id="restart-btn" class="secondary-btn big-play-btn">RESTART</button>
                        <button id="level-select-btn" class="secondary-btn big-play-btn">SELECT LEVEL</button>
                        <button id="exit-btn" class="secondary-btn big-play-btn">EXIT</button>
                    </div>
                </div>
            </div>





            <!-- Welcome Screen -->
            <!-- Main Menu / Welcome Screen -->
            <div id="welcome-screen" class="main-menu-bg">

                <!-- Background Video -->
                <video id="menu-bg-video" autoplay muted loop playsinline>
                    <source src="assets/maps/Default/a19be687-ec10-421d-8d5a-556fcd208e55.mp4" type="video/mp4">
                </video>

                <!-- Left Sidebar -->
                <div class="menu-sidebar">
                    <!-- Profile Header -->
                    <div class="profile-header">
                        <div class="profile-avatar-frame">
                            <img src="assets/units/soldier/Main_soldier.png" alt="Profile" class="profile-img">
                            <div class="level-badge">25</div>
                        </div>
                        <div class="profile-details">
                            <div class="profile-name">Elara</div>
                            <div class="profile-rank">Knight</div>
                        </div>
                    </div>

                    <!-- Sidebar Currency (Relocated) -->
                    <div class="sidebar-currency-display">
                        <div class="currency-item">
                            <div class="currency-icon token">‚öîÔ∏è</div>
                            <div class="currency-value">500</div>
                        </div>
                        <div class="currency-item">
                            <div class="currency-icon gold">üìÄ</div>
                            <div class="currency-value">1136</div>
                        </div>
                        <div class="currency-item">
                            <div class="currency-icon gem">üíé</div>
                            <div class="currency-value">50</div>
                        </div>
                    </div>

                    <!-- Main Navigation -->
                    <div class="main-nav-buttons">
                        <button id="play-battle-btn" class="main-menu-btn primary-gold">PLAY BATTLE</button>
                        <button class="main-menu-btn">UNITS</button>
                        <button class="main-menu-btn">TOWERS</button>
                        <button class="main-menu-btn">SHOP</button>
                        <button id="main-settings-btn" class="main-menu-btn">SETTINGS</button>
                        <button class="main-menu-btn">CLAN</button>
                    </div>
                </div>

                <!-- Game Logo Centered Top -->
                <div class="game-logo-container">
                    <h1 class="main-logo-text">TOWER ATTACK</h1>
                </div>

                <!-- Mode Selection Modal (Hidden by default, triggered by PLAY BATTLE) -->
                <div id="mode-select-popup" class="hidden">
                    <div class="glass-panel">
                        <h2>CHOOSE MODE</h2>
                        <div class="welcome-buttons">
                            <button id="campaign-btn" class="primary-btn big-play-btn">CAMPAIGN</button>
                            <button id="multiplayer-btn" class="secondary-btn big-play-btn">MULTIPLAYER</button>
                            <button id="mode-close-btn" class="secondary-btn big-play-btn">BACK</button>
                        </div>
                    </div>
                </div>

                <!-- Deck Selection Screen (Hidden by default) -->
                <div id="deck-screen" class="hidden full-screen-overlay">
                    <div class="deck-container glass-panel">
                        <button id="deck-back-btn" class="icon-btn close-btn">‚ùå</button>
                        <div class="deck-header">
                            <h2>MANAGE ARMY</h2>
                        </div>

                        <div class="preset-selector">
                            <div class="preset-label">DECK PRESETS</div>
                            <div class="preset-buttons">
                                <button class="preset-btn active" data-preset="0">1</button>
                                <button class="preset-btn" data-preset="1">2</button>
                                <button class="preset-btn" data-preset="2">3</button>
                            </div>
                        </div>

                        <div class="current-deck-section">
                            <h3>CURRENT DECK (MAX 6)</h3>
                            <div id="deck-slots" class="deck-grid">
                                <!-- Slots injected by JS -->
                            </div>
                        </div>

                        <div class="unit-pool-section">
                            <h3>AVAILABLE UNITS</h3>
                            <div id="unit-pool" class="pool-grid">
                                <!-- Units injected by JS -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Modal (Hidden by default) -->
                <div id="settings-modal" class="hidden">
                    <div class="glass-panel">
                        <h2>SETTINGS</h2>
                        <div class="settings-control">
                            <label for="volume-slider"
                                style="color: #ffd700; font-size: 1.2rem; display: block; margin-bottom: 10px;">MASTER
                                VOLUME</label>
                            <input type="range" id="volume-slider" min="0" max="100" value="50"
                                style="width: 80%; margin-bottom: 20px;">
                        </div>
                        <br>
                        <button id="settings-close-btn" class="secondary-btn big-play-btn">CLOSE</button>
                    </div>
                </div>

                <!-- Level Select Modal (Refactored) -->
                <div id="level-select-screen" class="hidden">
                    <div class="glass-panel">
                        <h2>SELECT LEVEL</h2>
                        <div id="level-list" class="menu-buttons">
                            <!-- Buttons injected by JS -->
                        </div>
                        <button id="level-back-btn" class="secondary-btn big-play-btn">BACK</button>
                    </div>
                </div>

                <!-- Multiplayer Mode Select Modal (Refactored) -->
                <div id="multiplayer-menu" class="hidden">
                    <div class="glass-panel">
                        <h2>MULTIPLAYER MODE</h2>
                        <div class="menu-buttons">
                            <button id="mp-local-btn" class="primary-btn big-play-btn">LOCAL (SAME WIFI/LAN)</button>
                            <button id="mp-online-btn" class="primary-btn big-play-btn">ONLINE</button>
                            <button id="mp-back-btn" class="secondary-btn big-play-btn">BACK</button>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </div>
    <!-- Socket.IO Client Library -->
    <script src="/socket.io/socket.io.js"></script>
    <script type="module" src="src/main.js"></script>
</body>

</html>